<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Email Accounts — TXB UniBox CRM</title>
  <meta name="description" content="Manage connected email accounts for cold outreach" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/src/styles/app.css" />
  <link rel="stylesheet" href="/src/styles/accounts.css" />
</head>
<body>
  <!-- Loading screen -->
  <div id="auth-loading" class="auth-loading">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <p>Authenticating...</p>
    </div>
  </div>

  <!-- App shell (hidden until authenticated) -->
  <div id="app-shell" class="app-shell" hidden>
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <svg width="32" height="32" viewBox="0 0 48 48" fill="none">
            <rect width="48" height="48" rx="12" fill="url(#logo-grad-a)" />
            <path d="M14 16h20v3H14zm0 6.5h14v3H14zm0 6.5h18v3H14z" fill="white" opacity="0.9"/>
            <path d="M34 28l4 4-4 4" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
            <defs>
              <linearGradient id="logo-grad-a" x1="0" y1="0" x2="48" y2="48">
                <stop stop-color="#6366f1"/>
                <stop offset="1" stop-color="#8b5cf6"/>
              </linearGradient>
            </defs>
          </svg>
          <span class="logo-text">UniBox</span>
        </div>
      </div>

      <nav class="sidebar-nav">
        <a href="/" class="nav-item" id="nav-dashboard">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
          <span>Dashboard</span>
        </a>
        <a href="#campaigns" class="nav-item" id="nav-campaigns">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
          <span>Campaigns</span>
        </a>
        <a href="#leads" class="nav-item" id="nav-leads">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87"/><path d="M16 3.13a4 4 0 010 7.75"/></svg>
          <span>Leads</span>
        </a>
        <a href="/accounts.html" class="nav-item active" id="nav-accounts">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="M22 7l-10 6L2 7"/></svg>
          <span>Email Accounts</span>
        </a>
        <a href="#warmup" class="nav-item" id="nav-warmup">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"/><path d="M12 6v6l4 2"/></svg>
          <span>Warmup</span>
        </a>
        <a href="#analytics" class="nav-item" id="nav-analytics">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 20V10"/><path d="M12 20V4"/><path d="M6 20v-6"/></svg>
          <span>Analytics</span>
        </a>
      </nav>

      <div class="sidebar-footer">
        <div class="user-profile" id="user-profile">
          <div class="user-avatar" id="user-avatar">?</div>
          <div class="user-info">
            <span class="user-name" id="user-name">Loading...</span>
            <span class="user-email" id="user-email">...</span>
          </div>
        </div>
        <button id="logout-btn" class="btn-logout" title="Sign out">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"/>
            <polyline points="16,17 21,12 16,7"/>
            <line x1="21" y1="12" x2="9" y2="12"/>
          </svg>
        </button>
      </div>
    </aside>

    <!-- Main content -->
    <main class="main-content">
      <header class="content-header">
        <div class="header-left">
          <h1>Email Accounts</h1>
          <p>Manage your connected email accounts for outreach.</p>
        </div>
        <div class="header-right">
          <button class="btn-primary" id="btn-add-account">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
            Add Account
          </button>
        </div>
      </header>

      <!-- Accounts Table -->
      <div class="accounts-table-wrapper">
        <div class="table-loading" id="table-loading">
          <div class="loading-spinner"></div>
          <p>Loading accounts...</p>
        </div>

        <div class="empty-state" id="empty-state" hidden>
          <div class="empty-icon">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.2" opacity="0.3">
              <rect x="2" y="4" width="20" height="16" rx="2"/>
              <path d="M22 7l-10 6L2 7"/>
            </svg>
          </div>
          <h3>No email accounts yet</h3>
          <p>Connect your first email account to start sending outreach campaigns.</p>
          <button class="btn-primary btn-empty-add" id="btn-empty-add">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
            Add Your First Account
          </button>
        </div>

        <table class="accounts-table" id="accounts-table" hidden>
          <thead>
            <tr>
              <th>Email Address</th>
              <th>Provider</th>
              <th>Display Name</th>
              <th>Daily Limit</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="accounts-tbody">
          </tbody>
        </table>
      </div>
    </main>
  </div>

  <!-- ═══ Add Account Modal ═══ -->
  <div class="modal-overlay" id="modal-overlay" hidden>
    <div class="modal" id="add-account-modal">
      <!-- Step 1: Choose Provider -->
      <div class="modal-step" id="step-choose-provider">
        <div class="modal-header">
          <h2>Connect Email Account</h2>
          <p>Choose your email provider to get started.</p>
          <button class="modal-close" id="modal-close">&times;</button>
        </div>
        <div class="modal-body">
          <div class="provider-grid">
            <button class="provider-card" id="provider-gmail">
              <div class="provider-icon provider-gmail-icon">
                <svg width="28" height="28" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">
                  <path fill="#4285F4" d="M43.6 20.1H42V20H24v8h11.3C33.9 33.4 29.3 36 24 36c-6.6 0-12-5.4-12-12s5.4-12 12-12c3 0 5.8 1.1 7.9 3l5.7-5.7C34 5.7 29.3 4 24 4 12.9 4 4 12.9 4 24s8.9 20 20 20 20-9 20-20c0-1.3-.1-2.6-.4-3.9z"/>
                  <path fill="#34A853" d="M6.3 14.7l6.6 4.8C14.5 15.5 18.8 12 24 12c3 0 5.8 1.1 7.9 3l5.7-5.7C34 5.7 29.3 4 24 4 16.3 4 9.7 8.3 6.3 14.7z"/>
                  <path fill="#FBBC05" d="M24 44c5.2 0 9.9-1.6 13.4-4.4l-6.2-5.2C29.3 36 26.8 37 24 37c-5.3 0-9.8-3.6-11.4-8.5l-6.5 5C9.5 39.6 16.2 44 24 44z"/>
                  <path fill="#EA4335" d="M43.6 20.1H42V20H24v8h11.3c-.8 2.2-2.2 4.1-4.1 5.4l6.2 5.2C36.6 39.3 44 34 44 24c0-1.3-.1-2.6-.4-3.9z"/>
                </svg>
              </div>
              <span class="provider-name">Gmail</span>
              <span class="provider-type">OAuth 2.0</span>
              <span class="provider-badge recommended">Recommended</span>
            </button>

            <button class="provider-card" id="provider-outlook">
              <div class="provider-icon provider-outlook-icon">
                <svg width="28" height="28" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">
                  <path fill="#1976D2" d="M28 13h14v22H28z"/>
                  <path fill="#2196F3" d="M28 13l7 8.5L28 30V13z"/>
                  <path fill="#1E88E5" d="M42 13l-7 8.5L42 30V13z"/>
                  <path fill="#1565C0" d="M28 30h14v5H28z"/>
                  <path fill="#42A5F5" d="M6 10h20v28H6z" opacity="0.9"/>
                  <path fill="white" d="M16 18c-3.3 0-6 2.7-6 6s2.7 6 6 6 6-2.7 6-6-2.7-6-6-6zm0 10c-2.2 0-4-1.8-4-4s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4z"/>
                </svg>
              </div>
              <span class="provider-name">Outlook</span>
              <span class="provider-type">OAuth 2.0</span>
              <span class="provider-badge coming-soon">Coming Soon</span>
            </button>

            <button class="provider-card" id="provider-smtp">
              <div class="provider-icon provider-smtp-icon">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <rect x="2" y="3" width="20" height="18" rx="2"/>
                  <path d="M8 10h8M8 14h5"/>
                  <circle cx="18" cy="18" r="3" fill="#6366f1" stroke="none"/>
                  <path d="M17 18h2M18 17v2" stroke="white" stroke-width="1.5"/>
                </svg>
              </div>
              <span class="provider-name">Custom SMTP/IMAP</span>
              <span class="provider-type">Manual Configuration</span>
            </button>
          </div>
        </div>
      </div>

      <!-- Step 2: Custom SMTP Form -->
      <div class="modal-step" id="step-smtp-form" hidden>
        <div class="modal-header">
          <button class="modal-back" id="smtp-back">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5"/><path d="M12 19l-7-7 7-7"/></svg>
          </button>
          <h2>Custom SMTP/IMAP</h2>
          <p>Enter your mail server details manually.</p>
          <button class="modal-close" id="smtp-close">&times;</button>
        </div>
        <div class="modal-body">
          <form id="smtp-form" autocomplete="off">
            <div class="form-section">
              <h4>Account Info</h4>
              <div class="form-row">
                <div class="form-group">
                  <label for="smtp-email">Email Address *</label>
                  <input type="email" id="smtp-email" placeholder="you@example.com" required />
                </div>
                <div class="form-group">
                  <label for="smtp-display-name">Display Name</label>
                  <input type="text" id="smtp-display-name" placeholder="John Doe" />
                </div>
              </div>
            </div>

            <div class="form-section">
              <h4>SMTP Settings (Sending)</h4>
              <div class="form-row">
                <div class="form-group flex-2">
                  <label for="smtp-host">SMTP Host *</label>
                  <input type="text" id="smtp-host" placeholder="smtp.example.com" required />
                </div>
                <div class="form-group flex-1">
                  <label for="smtp-port">Port *</label>
                  <input type="number" id="smtp-port" placeholder="587" value="587" required />
                </div>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label for="smtp-username">Username *</label>
                  <input type="text" id="smtp-username" placeholder="you@example.com" required />
                </div>
                <div class="form-group">
                  <label for="smtp-password">Password *</label>
                  <input type="password" id="smtp-password" placeholder="App password or mail password" required />
                </div>
              </div>
            </div>

            <div class="form-section">
              <h4>IMAP Settings (Receiving)</h4>
              <div class="form-row">
                <div class="form-group flex-2">
                  <label for="imap-host">IMAP Host *</label>
                  <input type="text" id="imap-host" placeholder="imap.example.com" required />
                </div>
                <div class="form-group flex-1">
                  <label for="imap-port">Port *</label>
                  <input type="number" id="imap-port" placeholder="993" value="993" required />
                </div>
              </div>
            </div>

            <div class="form-error" id="smtp-error" hidden></div>

            <div class="form-actions">
              <button type="button" class="btn-secondary" id="smtp-cancel">Cancel</button>
              <button type="submit" class="btn-primary" id="smtp-submit">
                <span class="btn-text">Connect Account</span>
                <span class="btn-loader" hidden>
                  <svg class="spinner" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/></svg>
                </span>
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast container -->
  <div class="toast-container" id="toast-container"></div>

  <script type="module" src="/src/pages/accounts.js"></script>
</body>
</html>
